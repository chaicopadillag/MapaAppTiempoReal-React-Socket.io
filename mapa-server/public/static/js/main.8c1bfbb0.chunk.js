(this["webpackJsonpmapa-tiempo-real-app"]=this["webpackJsonpmapa-tiempo-real-app"]||[]).push([[0],{50:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(43),o=n.n(a),r=(n(50),n(14)),u=n(44),i=n(1),s=Object(c.createContext)(),l=function(e){var t=e.children,n=function(e){var t=Object(c.useState)(!1),n=Object(r.a)(t,2),a=n[0],o=n[1],i=Object(c.useMemo)((function(){return u.io.connect(e,{transport:["websocket"]})}),[e]);return Object(c.useEffect)((function(){i.on("connect",(function(){o(!0)})),i.on("disconnect",(function(){o(!1)}))}),[i]),{socket:i,online:a}}("https://mapa-location.herokuapp.com"),a=n.socket,o=n.online;return Object(i.jsx)(s.Provider,{value:{socket:a,online:o},children:t})},f=n(45),b=n(88),j=n(11),d=n.n(j);d.a.workerClass=n(85).default,d.a.accessToken="pk.eyJ1IjoiY2hhaWNvcGFkaWxsYWciLCJhIjoiY2tseTU1N3pqMDBvNDJubzlsZm1jOWplcCJ9.luBsL5lsc18_ItnotezsHg";var m=function(e){var t=Object(c.useState)(e),n=Object(r.a)(t,2),a=n[0],o=n[1],u=Object(c.useRef)(),i=Object(c.useRef)(),s=Object(c.useRef)({}),l=Object(c.useCallback)((function(e){u.current=e}),[]),j=Object(c.useRef)(new b.a),m=Object(c.useRef)(new b.a),O=Object(c.useCallback)((function(e,t){var n=e.lngLat||e,c=n.lng,a=n.lat,o=new d.a.Marker;o.id=t||f.v4.v4(),o.setLngLat([c,a]).addTo(i.current).setDraggable(!0),s.current[o.id]=o,t||m.current.next({id:o.id,lng:c,lat:a}),o.on("drag",(function(e){var t=e.target,n=t.id,c=t.getLngLat(),a=c.lng,o=c.lat;j.current.next({id:n,lng:a,lat:o})}))}),[]),v=Object(c.useCallback)((function(e){var t=e.id,n=e.lng,c=e.lat;s.current[t].setLngLat([n,c])}),[]);return Object(c.useEffect)((function(){i.current=new d.a.Map({container:u.current,style:"mapbox://styles/mapbox/streets-v11",center:[e.lng,e.lat],zoom:e.zoom})}),[e]),Object(c.useEffect)((function(){var e;null===(e=i.current)||void 0===e||e.on("move",(function(){var e=i.current.getCenter(),t=e.lng,n=e.lat;o({lng:t.toFixed(4),lat:n.toFixed(4),zoom:i.current.getZoom().toFixed(2)})}))}),[]),Object(c.useEffect)((function(){var e;null===(e=i.current)||void 0===e||e.on("click",O)}),[O]),{agregarMarcador:O,coors:a,useRefMapa:l,nuevoMarcador$:m.current,movimientoMarcador$:j.current,actualizarPosicionMarcador:v}},O={lng:-77.0058,lat:-12.0058,zoom:14.7279},v=function(){var e=Object(c.useContext)(s).socket,t=m(O),n=t.coors,a=t.useRefMapa,o=t.nuevoMarcador$,r=t.movimientoMarcador$,u=t.agregarMarcador,l=t.actualizarPosicionMarcador;return Object(c.useEffect)((function(){e.on("marcadores-activos",(function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var c=n[t];u(e[c],c)}}))}),[e,u]),Object(c.useEffect)((function(){o.subscribe((function(t){e.emit("crear-marcador",t)}))}),[o,e]),Object(c.useEffect)((function(){r.subscribe((function(t){e.emit("actualizar-marcador",t)}))}),[e,r]),Object(c.useEffect)((function(){e.on("actualizar-posicion",(function(e){l(e)}))}),[e,l]),Object(c.useEffect)((function(){e.on("nuevo-marcador",(function(e){u(e,e.id)}))}),[e,u]),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("div",{className:"info",children:["Lng: ",n.lng," | Lat: ",n.lat," | Zoom: ",n.zoom]}),Object(i.jsx)("div",{ref:a,className:"mapa-container"})]})},g=function(){return Object(i.jsx)(l,{children:Object(i.jsx)(v,{})})};o.a.render(Object(i.jsx)(g,{}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.8c1bfbb0.chunk.js.map